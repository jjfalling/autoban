autoban

NOTE: This project is currently pre-alpha and the code will drastically change and I more then likely will push broken code. With that said I welcome anyone who wants to help develop this project )))
Also, this program may use ~100m of ram or more. 

The original version of autoban was developed at one of the internet's largest websites in order to block abuse and attacks that caused downtime. 

Autoban works by analyzing logs stored in elasticsearch against filters and rules then generating ban or block entries.



The current design is as follows (? denotes proposed and not yet created or designed):


Inputs            →           Filters        →       Outputs
[Nginx logs from ES]          [Whitelist]            [Nginx ban list]
[Apache logs from ES]         [Allow Rules]          [PfSense ip blocks?]
[Varnish logs from ES?]       [Blacklist?]           [Hosts.deny?]
[SSH logs from ES?]           [Block Rules]          [Iptables?]   
                              [geoip]                [Apache deny?]
								
								
You will need to use the logstash template for some fields to work correctly with this (such as anything with IPv6 IPs). You can find the template here: https://github.com/elasticsearch/logstash/blob/master/lib/logstash/outputs/elasticsearch/elasticsearch-template.json


Original version and concept developed with the assistance of Kurt Hurtado (https://github.com/kurtado)
