             _        _                 
  __ _ _   _| |_ ___ | |__   __ _ _ __  
 / _` | | | | __/ _ \| '_ \ / _` | '_ \ 
| (_| | |_| | || (_) | |_) | (_| | | | |
 \__,_|\__,_|\__\___/|_.__/ \__,_|_| |_|
 
 

NOTE: This project is currently pre-alpha and the code will drastically change and I more then likely will push broken code.
The original version of autoban was developed at one of the internet's largest websites in order to block abuse and attacks that caused downtime. 

Autoban works by analyzing logs stored in elasticsearch against filters and rules then generating ban or block entries.

Inputs gather data about ip addresses
Filters determine an action to take based upon the data from inputs
Outputs take an action based upon a filter



The current design is as follows (? denotes proposed and not yet created or designed):


Inputs            →           Filters        →       Outputs
[Nginx logs from ES]          [Whitelist]            [Nginx ban list]
[Apache logs from ES]         [Allow Rules]          [PfSense ip blocks?]
[Varnish logs from ES?]       [Blacklist?]           [Hosts.deny?]
[SSH logs from ES?]           [Block Rules]          [Iptables?]   
                              [geoip]                [Apache deny?]
	

							
								
You will need to use the logstash template for some fields to work correctly with this (such as anything with IPv6 IPs). You can find the template here: https://github.com/elasticsearch/logstash/blob/master/lib/logstash/outputs/elasticsearch/elasticsearch-template.json

Developed on ES version 1.0.1


Original version and concept developed in collaboration with Kurt Hurtado (https://github.com/kurtado)
