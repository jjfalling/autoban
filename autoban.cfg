#main autoban config
[autoban]
#es nodes to connect to
esNodes=192.168.13.14:9200,192.168.15.6:9200

#cnx_pool setting, see https://metacpan.org/pod/Search::Elasticsearch#cxn_pool-2
cnx_pool=Sniff

#name of es index for internal autoban data
esAutobanIndex=autoban



#plugins
[whitelist-filter]
whitelistips='192.168.15.0/24','192.168.13.0/24'


[geoip-filter]
#where is the geolite db installed? (ipv4 or 6)
geoliteDatabase=/var/lib/GeoIP/GeoIPv6.dat

#where is the geoorg db installed?
geoOrgDatabase=/var/lib/GeoIP/var/lib/GeoIP/GeoIPOrg.dat


[apache-es-input]

#what time period do you want to search for?
searchPeriod=now-15m

#how many of the top ips should we get?
topIps=50

#max number of results (requests) per ip
maxNumOfResults=100

#What feild contains the client ips to facet on?
facetFeild='clientip.raw'

#what is the es type feild for the apache logs?
logType=apacheAccess

#where can we find a copy of the current nginx ban file?
#http or local
share=local

#if you have a host that does internal tasks such as cache purges or other high-request taks and want to do compare your traffic to that host, use its ip here (ie if it does 30k req/min and nothing should ever do more requests/min then it). If not, leave this as a blank string
internalComparison='192.168.15.6'

#if something goes wrong and the above host (if supplied) does not have a hit count, what should be assume to be a normal value for that host?
internalComparisonBackupCount='1500'

#the only response codes you should see?
goodResponseCodes="200|302|304|401|306|500"

#what are some write urls? pipe sep, escpae ?, = and /
writeUrl='post.php|comments.html|html\?mode\=reply|\/edit'

#pipe seperated list of cookies that you use (leave blank to not use)
#cookies="omgnomnom|usersession"
cookies=



[nginx-es-input]

#what time period do you want to search for?
searchPeriod=now-15m

#how many of the top ips should we get?
topIps=50

#max number of results (requests) per ip
maxNumOfResults=100

#What feild contains the client ips to facet on?
facetFeild=remote_address.raw

#what is the es type feild for the nginx logs?
logType=nginxAccess

#if you have a host that does internal tasks such as cache purges or other high-request taks and want to do compare your traffic to that host, use its ip here (ie if it does 30k req/min and nothing should ever do more requests/min then it). If not, leave this as a blank string
internalComparison='192.168.15.6'

#if something goes wrong and the above host (if supplied) does not have a hit count, what should be assume to be a normal value for that host?
internalComparisonBackupCount='1500'

#the only response codes you should see?
goodResponseCodes="200|302|304|401|306|500"

#what are some write urls? pipe sep, escpae ?, = and /
writeUrl="post.php|comments.html|html\?mode\=reply|\/edit"

#pipe seperated list of cookies that you use (leave blank to not use)
#cookies="omgnomnom|usersession"
cookies=



[nginx-filter]

#what are ok crawlers that hit you hard? (use the name of the org as would be found in the geoorg db)
crawlers="microsoft|yandex|yahoo|google"

#where is the geolite db installed? (ipv4 or 6)
geoliteDatabase=/var/lib/GeoIP/GeoIPv6.dat

#you need to use the MaxMind GeoIP Organization Database. TODO: Migrate away from this?
#where is the geoorg db installed?
geoOrgDatabase=/var/lib/GeoIP/GeoIPOrg.dat


[nginx-ban-output]
#where can we find a copy of the current nginx ban file?
#http or local
share=local

#if http use full url with protocol. otherwise full path.
location=/tmp/nginxban.conf
